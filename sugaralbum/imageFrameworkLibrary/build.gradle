import com.android.builder.core.BuilderConstants

apply plugin: 'com.android.library'

android {
    compileSdk 35

    defaultConfig {
        version 3
        minSdkVersion 24
        targetSdkVersion 35

        ndk {
            moduleName "native_filter"
            ldLibs "log"
            stl "c++_static"
        }
        renderscriptTargetApi 18
        renderscriptSupportModeEnabled true
        ndk.abiFilters 'armeabi', 'armeabi-v7a', 'arm64-v8a'
    }

    packagingOptions {
        exclude 'META-INF/ASL2.0'
        exclude 'META-INF/LICENSE'
        exclude 'META-INF/MANIFEST.MF'
        exclude 'META-INF/NOTICE'
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.txt'
        }
    }

    allprojects {
        sourceCompatibility = 1.8
        targetCompatibility = 1.8
    }

    ndkVersion '25.1.8937393'
    namespace 'com.kiwiple.imageframework'
    buildFeatures {
        aidl true
    }

    libraryVariants.all { variant ->
        variant.outputs.each { output ->
            if (output.outputFileName != null && output.outputFileName.endsWith('.aar')) {
                if (name == com.android.builder.core.BuilderConstants.RELEASE) {
                    output.outputFileName = new File("${archivesBaseName}-v${version}r.aar")
                }else{
                    output.outputFileName = new File("${archivesBaseName}-v${version}d.aar")
                }
            }
        }
    }
}

dependencies {
//    compile files('libs/android-support-v4.jar')
    api 'androidx.legacy:legacy-support-v4:1.0.0'
//    compile "com.android.support:appcompat-v7:23.0.1"
    api files('libs/httpclient-4.1.1.jar')
    api files('libs/httpcore-4.1.jar')
    api files('libs/httpmime-4.2.5.jar')
    api files('libs/renderscript-v8.jar')
    api files('libs/jackson-core-asl-1.9.12.jar')
    api files('libs/jackson-mapper-asl-1.9.12.jar')
    api files('libs/sd-sdk-device-info.jar')
    api files('libs/sd-sdk-facial-processing.jar')
}

copy {
    from 'build/outputs/aar'
    into "../aarlibs/release"
    include '**/*r.aar'
}

